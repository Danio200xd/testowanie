---
- name: Konfiguracja firewall na Mikrotiku
  hosts: all
  gather_facts: no
  ansible_ssh_common_args: '-J user@jump_host'
  tasks:
    - name: Dodaj adres do listy
      ansible.builtin.raw: /ip firewall address-list add list=adres address=192.168.88.110

    - name: Zezwól na połączenia established i related
      ansible.builtin.raw: /ip firewall filter add chain=input connection-state=established,related action=accept

    - name: Zezwól na SSH tylko z określonej listy adresów
      ansible.builtin.raw: /ip firewall filter add chain=input protocol=tcp dst-port=22 src-address-list="nazwa adresu" action=accept

    - name: Zablokuj pozostałe połączenia SSH
      ansible.builtin.raw: /ip firewall filter add chain=input protocol=tcp dst-port=22 action=drop
